{"ast":null,"code":"import _objectSpread from \"/Users/anadoc/Desktop/Skillbox Anastasia/Skillbox Projects/Vue.js Shop/Vue.js/07_api_1/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport Vue from \"vue\";\nimport Vuex from 'vuex';\nimport axios from 'axios';\nimport { API_BASE_URL } from '@/config';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    cartProducts: [],\n    userAccessKey: null,\n    cartProductsData: []\n  },\n  mutations: {\n    addProductToCart: function addProductToCart(state, _ref) {\n      var productId = _ref.productId,\n        amount = _ref.amount;\n      var item = state.cartProducts.find(function (item) {\n        return item.productId === productId;\n      });\n      if (item) {\n        item.amount += amount;\n      } else {\n        state.cartProducts.push({\n          productId: productId,\n          amount: amount\n        });\n      }\n    },\n    updateCartProductAmount: function updateCartProductAmount(state, _ref2) {\n      var productId = _ref2.productId,\n        amount = _ref2.amount;\n      var item = state.cartProducts.find(function (item) {\n        return item.productId === productId;\n      });\n      if (item) {\n        item.amount = amount;\n      }\n    },\n    deleteCartProduct: function deleteCartProduct(state, productId) {\n      state.cartProducts = state.cartProducts.filter(function (item) {\n        return item.productId !== productId;\n      });\n    },\n    updateUserAccessKey: function updateUserAccessKey(state, accessKey) {\n      state.userAccessKey = accessKey;\n    },\n    updateCartProductsData: function updateCartProductsData(state, items) {\n      state.cartProductsData = items;\n    },\n    syncCartProducts: function syncCartProducts(state) {\n      state.cartProducts = state.cartProductsData.map(function (item) {\n        return {\n          productId: item.product.id,\n          amount: item.quantity\n        };\n      });\n    }\n  },\n  getters: {\n    cartDetailProducts: function cartDetailProducts(state) {\n      return state.cartProducts.map(function (item) {\n        var product = state.cartProductsData.find(function (p) {\n          return p.product.id === item.productId;\n        }).product;\n        return _objectSpread(_objectSpread({}, item), {}, {\n          product: _objectSpread(_objectSpread({}, product), {}, {\n            image: product.image.file.url\n          })\n        });\n      });\n    },\n    cartTotalPrice: function cartTotalPrice(state, getters) {\n      return getters.cartDetailProducts.reduce(function (acc, item) {\n        return item.product.price * item.amount + acc;\n      }, 0);\n    }\n  },\n  actions: {\n    loadCart: function loadCart(context) {\n      axios.get(API_BASE_URL + '/api/baskets', {\n        params: {\n          userAccessKey: context.state.userAccessKey\n        }\n      }).then(function (response) {\n        if (!context.state.userAccessKey) {\n          localStorage.setItem('userAccessKey', response.data.user.accessKey);\n          context.commit('updateUserAccessKey', response.data.user.accessKey);\n        }\n        context.commit('updateCartProductsData', response.data.items);\n        context.commit('syncCartProducts');\n      });\n    },\n    addProductToCart: function addProductToCart(context) {}\n  }\n});","map":{"version":3,"names":["Vue","Vuex","axios","API_BASE_URL","use","Store","state","cartProducts","userAccessKey","cartProductsData","mutations","addProductToCart","_ref","productId","amount","item","find","push","updateCartProductAmount","_ref2","deleteCartProduct","filter","updateUserAccessKey","accessKey","updateCartProductsData","items","syncCartProducts","map","product","id","quantity","getters","cartDetailProducts","p","_objectSpread","image","file","url","cartTotalPrice","reduce","acc","price","actions","loadCart","context","get","params","then","response","localStorage","setItem","data","user","commit"],"sources":["/Users/anadoc/Desktop/Skillbox Anastasia/Skillbox Projects/Vue.js Shop/Vue.js/07_api_1/src/store/index.js"],"sourcesContent":["import Vue from \"vue\";\nimport Vuex from 'vuex';\nimport axios from 'axios';\nimport { API_BASE_URL } from '@/config';\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n    state: {\n        cartProducts: [],\n        userAccessKey: null,\n        cartProductsData: []\n    },\n    mutations: {\n        addProductToCart(state, { productId, amount }) {\n            const item = state.cartProducts.find(item => item.productId === productId);\n\n            if (item) {\n                item.amount += amount;\n            } else {\n                state.cartProducts.push({\n                    productId,\n                    amount,\n                });\n            }\n        },\n        updateCartProductAmount(state, { productId, amount }) {\n            const item = state.cartProducts.find(item => item.productId === productId);\n\n            if (item) {\n                item.amount = amount;\n            }\n        },\n        deleteCartProduct(state, productId) {\n            state.cartProducts = state.cartProducts.filter(item => item.productId !== productId);\n        },\n        updateUserAccessKey(state, accessKey) {\n            state.userAccessKey = accessKey;\n        },\n        updateCartProductsData(state, items) {\n            state.cartProductsData = items;\n        },\n        syncCartProducts(state) {\n            state.cartProducts = state.cartProductsData.map(item => {\n                return {\n                    productId: item.product.id,\n                    amount: item.quantity\n                }\n            });\n        }\n    },\n    getters: {\n        cartDetailProducts(state) {\n            return state.cartProducts.map(item => {\n                const product = state.cartProductsData.find(p => p.product.id === item.productId).product;\n                return {\n                    ...item,\n                    product: {\n                        ...product,\n                        image: product.image.file.url\n                    }\n                }\n            });\n        },\n        cartTotalPrice(state, getters) {\n            return getters.cartDetailProducts.reduce((acc, item) => (item.product.price * item.amount) + acc, 0);\n        }\n    },\n    actions: {\n        loadCart(context) {\n            axios.get(API_BASE_URL + '/api/baskets', {\n                params: {\n                    userAccessKey: context.state.userAccessKey\n                }\n            })\n                .then(response => {\n                    if (!context.state.userAccessKey) {\n                        localStorage.setItem('userAccessKey', response.data.user.accessKey);\n                        context.commit('updateUserAccessKey', response.data.user.accessKey);\n                    }\n                    context.commit('updateCartProductsData', response.data.items);\n                    context.commit('syncCartProducts');\n                })\n        },\n        addProductToCart(context, ) {\n\n        }\n    }\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}